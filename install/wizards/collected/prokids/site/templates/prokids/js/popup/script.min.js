/*
 * Copyright (c) 16/12/2019 Created By/Edited By ASDAFF asdaff.asad@yandex.ru
 */

var CollectJS_PopupPrefix="rsgppopup_",CollectJS_DivsLeft='<div class="outer"><div class="inner">',CollectJS_DivsRight="</div></div>",CollectJS_ParentsObj;function CollectJS_OnOfferChangePopup(a){var c=a.find(".js-add2basketpid").val();var b=a.data("elementid");if(c>0){if(CollectJS_OFFERS[b].OFFERS[c].IMAGES[0].src&&CollectJS_OFFERS[b].OFFERS[c].IMAGES[0].src.indexOf("collected_devlibrary_nophoto")<0&&a.find(".pic img").length>0){a.find(".pic img").attr("src",CollectJS_OFFERS[b].OFFERS[c].IMAGES[0].src)}}}function CollectProPricesJScrollPaneReinitialize(){setTimeout(function(){var a;$(".prs_jscrollpane").parents(".prices").removeClass("jspHasScroll");$(".prs_jscrollpane").each(function(b){a=$(this).data("jsp");a.reinitialise();if($(this).hasClass("jspScrollable")){$(this).parents(".prices").addClass("jspHasScroll")}})},50)}function CollectJS_FixPreviewText(a){var b=350;var f=18;var d=$("#"+CollectJS_PopupPrefix+a).find(".block.right").outerHeight(true);if(d!=null){if(d>b){var e=$("#"+CollectJS_PopupPrefix+a).find(".description").find(".text");var c=Math.floor((e.outerHeight(true)-(d-b))/f)*f;e.css("maxHeight",c+"px")}}}function CollectJS_GoPopup(a,b){a=parseInt(a);CollectJS_ParentsObj=b;if(a>0){if($("#"+CollectJS_PopupPrefix+a).length>0){CollectJS_ShowPopup(a)}else{CollectJS_AddPopup(a)}}else{console.warn("GoPopup: element_id is empty")}}function CollectJS_ShowPopup(a){CollectJS_ChangePosition(a);$("#"+CollectJS_PopupPrefix+a).fadeIn("fast",function(){CollectJS_FixPreviewText(a);CollectJS_SetSet();CollectJS_ScrollReinit(".elementpopupinner .prs_jscrollpane",1)})}function CollectJS_HidePopup(a){$("#"+CollectJS_PopupPrefix+a).fadeOut("fast",function(){})}function CollectJS_ChangePosition(b){var c;if(CollectJS_ParentsObj.find("td.name").outerWidth(true)>5){c=CollectJS_ParentsObj.find(".js-position")}else{c=CollectJS_ParentsObj.parents(".artables").find(".js-name"+b).find(".js-position")}var a=c.position().left+c.outerWidth(true)+20;$("#"+CollectJS_PopupPrefix+b).css({top:c.position().top+"px",left:a+"px"})}function CollectJS_HideAllPopup(){$(".rsgppopup:visible").fadeOut("fast",function(){})}function CollectJS_AddPopup(a,d){var b=SITE_DIR+SITE_CATALOG_PATH+"/?AJAX_CALL=Y&action=rsgppopup&element_id="+a+"";var c='<div id="'+CollectJS_PopupPrefix+a+'" class="rsgppopup" style="display:none;">'+CollectJS_DivsLeft+'<div class="loading"></div>'+CollectJS_DivsRight+"</div>";$("body").append(c);CollectJS_ShowPopup(a);$.ajax({url:b}).done(function(e){$("#"+CollectJS_PopupPrefix+a).find(".inner").html(e);CollectJS_SetSet();CollectJS_FixPreviewText(a);if($(".elementpopupinner .prs_jscrollpane").length>0){CollectJS_ScrollInit(".elementpopupinner .prs_jscrollpane");$(window).resize(function(){CollectJS_ScrollReinit(".elementpopupinner .prs_jscrollpane",1)})}}).fail(function(){console.warn("Popup: wrong ajax request")})}$(document).ready(function(){$(document).on("keydown",function(a){if(a.keyCode==27){CollectJS_HideAllPopup()}});$(document).on("click",function(a){if($(a.target).parents(".rsgppopup").length>0){}else{CollectJS_HideAllPopup()}});$(window).resize(function(){CollectJS_HideAllPopup()});$(document).on("CollectProOnOfferChange",function(b,a){CollectJS_OnOfferChangePopup(a)})});